<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@microsoft/teamsfx](./teamsfx.md) &gt; [BotBuilderCloudAdapter](./teamsfx.botbuildercloudadapter.md) &gt; [ConversationBot](./teamsfx.botbuildercloudadapter.conversationbot.md)

## BotBuilderCloudAdapter.ConversationBot class

Provide utilities for bot conversation, including: - handle command and response. - send notification to varies targets (e.g., member, group, channel).

**Signature:**

```typescript
export declare class ConversationBot 
```

## Remarks

Set `adapter` in [ConversationOptions](./teamsfx.conversationoptions.md) to use your own bot adapter.

For command and response, ensure each command should ONLY be registered with the command once, otherwise it'll cause unexpected behavior if you register the same command more than once.

For notification, set `notification.storage` in [ConversationOptions](./teamsfx.conversationoptions.md) to use your own storage implementation.

## Example

For command and response, you can register your commands through the constructor, or use the `registerCommand` and `registerCommands` API to add commands later.

```typescript
import { BotBuilderCloudAdapter } from "@microsoft/teamsfx";
import ConversationBot = BotBuilderCloudAdapter.ConversationBot;

// register through constructor
const conversationBot = new ConversationBot({
  command: {
    enabled: true,
    commands: [ new HelloWorldCommandHandler() ],
  },
});

// register through `register*` API
conversationBot.command.registerCommand(new HelpCommandHandler());
```
For notification, you can enable notification at initialization, then send notifications at any time.

```typescript
import { BotBuilderCloudAdapter } from "@microsoft/teamsfx";
import ConversationBot = BotBuilderCloudAdapter.ConversationBot;

// enable through constructor
const conversationBot = new ConversationBot({
  notification: {
    enabled: true,
  },
});

// get all bot installations and send message
for (const target of await conversationBot.notification.installations()) {
  await target.sendMessage("Hello Notification");
}

// alternative - send message to all members
for (const target of await conversationBot.notification.installations()) {
  for (const member of await target.members()) {
    await member.sendMessage("Hello Notification");
  }
}
```

## Constructors

|  Constructor | Modifiers | Description |
|  --- | --- | --- |
|  [(constructor)(options)](./teamsfx.botbuildercloudadapter.conversationbot._constructor_.md) |  | Create new instance of the <code>ConversationBot</code>. |

## Properties

|  Property | Modifiers | Type | Description |
|  --- | --- | --- | --- |
|  [adapter](./teamsfx.botbuildercloudadapter.conversationbot.adapter.md) | <code>readonly</code> | CloudAdapter | The bot adapter. |
|  [cardAction?](./teamsfx.botbuildercloudadapter.conversationbot.cardaction.md) | <code>readonly</code> | CardActionBot | _(Optional)_ The action handler used for adaptive card universal actions. |
|  [command?](./teamsfx.botbuildercloudadapter.conversationbot.command.md) | <code>readonly</code> | CommandBot | _(Optional)_ The entrypoint of command and response. |
|  [notification?](./teamsfx.botbuildercloudadapter.conversationbot.notification.md) | <code>readonly</code> | NotificationBot | _(Optional)_ The entrypoint of notification. |

## Methods

|  Method | Modifiers | Description |
|  --- | --- | --- |
|  [requestHandler(req, res, logic)](./teamsfx.botbuildercloudadapter.conversationbot.requesthandler.md) |  | The request handler to integrate with web request. |

