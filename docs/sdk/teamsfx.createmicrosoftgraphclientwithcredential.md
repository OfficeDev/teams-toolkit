<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@microsoft/teamsfx](./teamsfx.md) &gt; [createMicrosoftGraphClientWithCredential](./teamsfx.createmicrosoftgraphclientwithcredential.md)

## createMicrosoftGraphClientWithCredential() function

> Warning: This API is now obsolete.
> 
> Use `TokenCredentialAuthenticationProvider` and `Client.initWithMiddleware` instead.
> 
> ```typescript
> const authProvider = new TokenCredentialAuthenticationProvider(credential, { scopes: scope });
> const graph = Client.initWithMiddleware({
>   authProvider: authProvider,
> });
> ```
> 

Get Microsoft graph client.

<b>Signature:</b>

```typescript
export declare function createMicrosoftGraphClientWithCredential(credential: TokenCredential, scopes?: string | string[]): Client;
```

## Parameters

|  Parameter | Type | Description |
|  --- | --- | --- |
|  credential | TokenCredential | Used to provide configuration and auth. |
|  scopes | string \| string\[\] | The array of Microsoft Token scope of access. Default value is <code>[.default]</code>. |

<b>Returns:</b>

Client

Graph client with specified scopes.

## Exceptions

[InvalidParameter](./teamsfx.errorcode.md) when scopes is not a valid string or string array.

## Example

Get Microsoft graph client by TokenCredential

```typescript
// In browser: TeamsUserCredential
const authConfig: TeamsUserCredentialAuthConfig = {
  clientId: "xxx",
    initiateLoginEndpoint: "https://xxx/auth-start.html",
};

const credential = new TeamsUserCredential(authConfig);

const scope = "User.Read";
await credential.login(scope);

const client = createMicrosoftGraphClientWithCredential(credential, scope);

// In node: OnBehalfOfUserCredential
const oboAuthConfig: OnBehalfOfCredentialAuthConfig = {
  authorityHost: "xxx",
  clientId: "xxx",
  tenantId: "xxx",
  clientSecret: "xxx",
};

const oboCredential = new OnBehalfOfUserCredential(ssoToken, oboAuthConfig);
const scope = "User.Read";
const client = createMicrosoftGraphClientWithCredential(oboCredential, scope);

// In node: AppCredential
const appAuthConfig: AppCredentialAuthConfig = {
  authorityHost: "xxx",
  clientId: "xxx",
  tenantId: "xxx",
  clientSecret: "xxx",
};
const appCredential = new AppCredential(appAuthConfig);
const scope = "User.Read";
const client = createMicrosoftGraphClientWithCredential(appCredential, scope);

const profile = await client.api("/me").get();
```

